# NTO-II-

# üìö Book Rating Prediction Pipeline  
**–°–∫–æ—Ä: 0,7662005334200266** ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω—ã–π, production-ready –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Ü–µ–Ω–æ–∫ –∫–Ω–∏–≥.

## üîç –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è

**–ú–æ–¥–µ–ª—å:** LightGBM (—Ä–µ–∂–∏–º —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ `rmse`) —Å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π –∏ early stopping (100 —Ä–∞—É–Ω–¥–æ–≤).

**–í–∞–ª–∏–¥–∞—Ü–∏—è:** **Temporal Split** ‚Äî –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –ø–µ—Ä–≤—ã—Ö 85% –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤—Ä–µ–º–µ–Ω–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 15%. –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–∞–µ—Ç *data leakage* –∏ –∏–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π –æ–Ω–ª–∞–π–Ω-—Å—Ü–µ–Ω–∞—Ä–∏–π.

### –ü—Ä–∏–∑–Ω–∞–∫–∏ (Features)
| –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| üïí **–í—Ä–µ–º–µ–Ω–Ω—ã–µ** | –ß–∞—Å, –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏, —Å–µ–∑–æ–Ω, –≤—ã—Ö–æ–¥–Ω—ã–µ/–±—É–¥–Ω–∏ (–∏–∑ `timestamp`) |
| üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ** | `user_mean_rating`, `book_ratings_count`, `author_mean_rating` –∏ –∏—Ö std/min/max |
| üîó **–ò–Ω—Ç–µ—Ä–∞–∫—Ü–∏–∏** | `rating_diff_user_book`, `rating_count_ratio`, –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ |
| üìù **–¢–µ–∫—Å—Ç–æ–≤—ã–µ** | TF-IDF (300 —Ñ–∏—á) + 3 —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (`tfidf_sum`, `mean`, `max`) –Ω–∞ –æ—á–∏—â–µ–Ω–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω–∏—è—Ö –∫–Ω–∏–≥ |
| üéØ **Target Encoding** | –°–≥–ª–∞–∂–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥–Ω–∏–µ –¥–ª—è `author_id`, `publisher`, `language` (Bayesian smoothing) |

### –ü–æ—Å—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥  
- **–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –º–µ–¥–∏–∞–Ω—ã**: —Å–¥–≤–∏–≥ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –ø–æ–¥ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–µ–π–Ω–∞ (—á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ 80%)  
- **Soft clipping**: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ `[0.5, 9.5]` —Å –ª–∏–Ω–µ–π–Ω—ã–º –∑–∞—Ç—É—Ö–∞–Ω–∏–µ–º —É –≥—Ä–∞–Ω–∏—Ü  
- **–û–∫—Ä—É–≥–ª–µ–Ω–∏–µ**: –¥–æ 2 –∑–Ω–∞–∫–æ–≤ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ñ–æ—Ä–º–∞—Ç—É —Å–∞–±–º–∏—Ç–∞

---

## üë®‚Äçüíª –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–≤–∞–π–±–∫–æ–¥–∏–Ω–≥)

–†–µ—à–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ —á–µ—Ä–µ–∑ **–≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥**: LLM –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª —à–∞–±–ª–æ–Ω–Ω—ã–π –∫–æ–¥, —è —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–ª—Å—è –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≥–∏–ø–æ—Ç–µ–∑ –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö.

### –≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã:
1. **‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è**  
   ‚Äî –Ø –æ–ø—Ä–µ–¥–µ–ª–∏–ª —Å—Ç—Ä–∞—Ç–µ–≥–∏—é *Temporal Split* –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.  
   ‚Äî –ó–∞–ø—Ä–µ—Ç–∏–ª —Å–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ ‚Äî –æ–Ω–æ –∑–∞–≤—ã—à–∞–µ—Ç —Å–∫–æ—Ä, –Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.

2. **‚öôÔ∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞**  
   ‚Äî LLM —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª:  
     ‚Ä¢ –ö–ª–∞—Å—Å—ã `config`/`constants`  
     ‚Ä¢ `reduce_mem_usage()` (—ç–∫–æ–Ω–æ–º–∏—è –¥–æ 80% RAM)  
     ‚Ä¢ TF-IDF + –æ—á–∏—Å—Ç–∫—É —Ç–µ–∫—Å—Ç–∞  
   ‚Äî –Ø –¥–æ–±–∞–≤–∏–ª –∑–∞—â–∏—Ç—É –æ—Ç `NaN` –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö —Ñ–∏—á–∞—Ö –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É `Period`-—Ç–∏–ø–æ–≤.

3. **üîß –¢—é–Ω–∏–Ω–≥ –∏ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è**  
   ‚Äî –Ø –Ω–∞—Å—Ç—Ä–æ–∏–ª: `learning_rate=0.01`, `num_leaves=63`, `min_child_samples=30`.  
   ‚Äî –û—Ç–∫–ª—é—á–∏–ª –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (BERT, ALS, –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è) –¥–ª—è 100% –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏.

4. **üéØ –ü–æ—Å—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥**  
   ‚Äî –ò–¥–µ—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –º–µ–¥–∏–∞–Ω—ã ‚Äî –º–æ—è.  
   ‚Äî –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø—Ä–æ–º–ø—Ç: *¬´–°–¥–µ–ª–∞–π —á–∞—Å—Ç–∏—á–Ω—ã–π —Å–¥–≤–∏–≥ (80%), –∞ –Ω–µ –ø–æ–ª–Ω—ã–π, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ—É—Å–µ—Ä–¥—Å—Ç–≤–æ–≤–∞—Ç—å¬ª*.

---

## üöÄ –ó–∞–ø—É—Å–∫

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install numpy pandas scikit-learn lightgbm nltk tqdm

# 2. –ü–æ–ª–æ–∂–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ—Ä–µ–Ω—å:
#    train.csv, test.csv, books.csv, users.csv, book_descriptions.csv

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ
python solution.py
